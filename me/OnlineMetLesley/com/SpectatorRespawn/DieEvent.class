package me.OnlineMetlesley.com.SpectatorRespawn;

import net.md_5.bungee.api.ChatColor;
import org.bukkit.GameMode;
import org.bukkit.entity.Player;
import org.bukkit.event.EventHandler;
import org.bukkit.event.Listener;
import org.bukkit.event.entity.EntityDamageEvent;

public class DieEvent implements Listener {
   String deathmessage;

   public DieEvent() {
      this.deathmessage = Main.instance.getConfig().getString("DeathMessage");
   }

   @EventHandler
   public void damage(EntityDamageEvent event) {
      Player player = (Player)event.getEntity();
      if (player.getHealth() - event.getFinalDamage() <= 0.0D && event.getEntity() instanceof Player) {
         event.setCancelled(true);
         player.setGameMode(GameMode.SPECTATOR);
         player.sendMessage(ChatColor.translateAlternateColorCodes('&', this.deathmessage.replace("%player%", player.getName())));
      }

   }
}
